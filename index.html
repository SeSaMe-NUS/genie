<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GENIE: User&#39;s guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GENIE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">User's guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="overview_sec"></a>
Overview</h1>
<p>GENIE is a Generic Inverted Index on the GPU. It builds the database from a csv file or a vector of instances. Then GENIE will consturct the inverted list table and transfer it to the device. GENIE provides a simple way to perform the similarity queries. User may define queries and their matching ranges, then directly call the matching funtion. The library will parallel process all queries and save the matching result into a device_vector. A top k search can also be simply perfromed. GENIE uses parallel searching to determine the top k values in a vector. It is much faster than the CPU searching algorithm. All device methods are wrapped in host methods. Developers are not required to configure the device function call. Please refer to the following documents:</p>
<blockquote class="doxtable">
<p>Generic Inverted Index on the GPU, Technical Report (TR 11/15), School of Computing, NUS. <br />
 Generic Inverted Index on the GPU, CoRR arXiv:1603.08390 at www.comp.nus.edu.sg/~atung/publication/gpugenie.pdf </p>
</blockquote>
<h1><a class="anchor" id="install_sec"></a>
Installation</h1>
<p>You are required to install G++, CMake, CUDA, OpenMPI and Boost. The minimum required versions are:</p>
<ul>
<li>GCC with C++11 support (4.8)</li>
<li>CMake 3.8</li>
<li>CUDA 7.0</li>
<li>OpenMPI 1.7 (for <code>GENIE_DISTRIBUTED</code> only)</li>
<li>Boost 1.63: serialization (always required), program_options (for <code>GENIE_COMPR</code> only)</li>
</ul>
<p>To create an "out-of-source" build of GENIE containing both the GENIE library, tests and tools, you can use the standard CMake procedure:</p>
<div class="fragment"><div class="line">$ mkdir build</div><div class="line">$ cd build</div><div class="line">$ cmake ..</div><div class="line">$ make -j8</div></div><!-- fragment --><p>Use target <code>$ make test</code> to run GENIE tests, <code>$ make doc</code> to build html code documentation, <code>$ make install</code> to install GENIE.</p>
<p><code>CMake</code> build parameters can be further configured using the following options:</p>
<ul>
<li><code>CMAKE_BUILD_TYPE:STRING</code> &ndash; build type, one of <code>Release</code>, <code>Debug</code> (default <code>Release</code>)</li>
<li><code>CMAKE_INSTALL_PREFIX:PATH</code> &ndash; <code>cmake</code>'s option for installation prefix (default <code>${CMAKE_BINARY_DIR}/install</code>)</li>
<li><code>BOOST_ROOT:PATH</code> &ndash; root dir of Boost libraries (default from system paths)</li>
<li><code>DOXYGEN_EXECUTABLE:PATH</code> &ndash; doxygen executable (default from system paths)</li>
<li><code>MPI_HOME:PATH</code> &ndash; root dir of OpenMPI installation (default from system paths)</li>
<li><code>GENIE_DISTRIBUTED:BOOL</code> &ndash; enable distributed GENIE module (default OFF)</li>
<li><code>GENIE_COMPR:BOOL</code> &ndash; enable compression GENIE module (default OFF)</li>
<li><code>GENIE_SIMDCAI:BOOL</code> &ndash; enable compilation of SIMDCAI library (default OFF)</li>
<li><code>GENIE_EXAMPLES:BOOL</code> &ndash; enable compilation of GENIE examples (default ON)</li>
</ul>
<p>Example use of <code>cmake</code> command may look like this:</p>
<div class="fragment"><div class="line">$ cmake -DGENIE_SIMDCAI=ON -DCMAKE_BUILD_TYPE=Release -DGENIE_DISTRIBUTED=ON -DGENIE_COMPR=ON \</div><div class="line">        -DBOOST_ROOT=/home/lubos/boost -DCMAKE_INSTALL_PREFIX=/home/lubos/genie-install ..</div></div><!-- fragment --><h1><a class="anchor" id="usage_sec"></a>
Usage</h1>
<h2><a class="anchor" id="usage_library_sec"></a>
Using GENIE as a library</h2>
<p>The GENIE interface consists of 4 important classes. They are</p>
<ul>
<li><code><a class="el" href="classgenie_1_1Config.html" title="Config class holds all user configurable settings of GENIE. ">genie::Config</a></code> for configuring GENIE</li>
<li><code><a class="el" href="classgenie_1_1ExecutionPolicy.html" title="ExecutionPolicy class is the interface for building table, building query, and matching. ">genie::ExecutionPolicy</a></code> for providing implementation for building table, building query, and matching</li>
<li><code><a class="el" href="classGPUGenie_1_1inv__table.html" title="The declaration for class inv_table. ">GPUGenie::inv_table</a></code> for the constructed tables</li>
<li><code><a class="el" href="classGPUGenie_1_1query.html" title="Query class includes the functions for processing queries based on user&#39;s input. ">GPUGenie::query</a></code> for the constructed queries</li>
</ul>
<p>The interface also has several <a href="namespacegenie.html#func-members">functions</a>. The <code><a class="el" href="namespacegenie.html#a474230dd19d21b51f6e5dac6535d9364" title="1st-level interface for end-to-end matching with given table and query CSV file paths. ">genie::Search()</a></code> function is the 1st-level interface function for using GENIE. It accepts file paths to table and query CSV files and returns the matching result. There are also several 2nd-level interface functions, which are used internally by the <code><a class="el" href="namespacegenie.html#a474230dd19d21b51f6e5dac6535d9364" title="1st-level interface for end-to-end matching with given table and query CSV file paths. ">genie::Search()</a></code> function. These 2nd-level functions are meant to provide finer control of GENIE for advanced usage. These functions are</p>
<ul>
<li><code><a class="el" href="namespacegenie.html#ae1b857f34a6de488acacdb58db805448" title="2nd-level interface for building table with TableData. ">genie::BuildTable()</a></code> for build the inverted index</li>
<li><code><a class="el" href="namespacegenie.html#a6df61bf772c376700ca20e74c59ffc5a" title="2nd-level interface for building queries with table and QueryData. ">genie::BuildQuery()</a></code> for build the queries</li>
<li><code><a class="el" href="namespacegenie.html#ad2792d964ef384f74dc1f62a2564bd23" title="2nd-level interface for matching with pre-built table and queries. ">genie::Match()</a></code> for matching</li>
</ul>
<p>To use GENIE, it should first be configured with the <code><a class="el" href="classgenie_1_1Config.html" title="Config class holds all user configurable settings of GENIE. ">genie::Config</a></code> class. According to the configurations, a corresponding execution policy could be generated with <code><a class="el" href="namespacegenie.html#a65a8a0a253fab2bc932af6d0c54c0183" title="Builds and returns a policy according to the configurations. ">genie::MakePolicy()</a></code>. Then the interface functions could be used to perform the search. Below is an example program demonstrating the usage of GENIE.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="genie_8h.html">GPUGenie/interface/genie.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacegenie.html">genie</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="genie_8cu.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>()</div><div class="line">{</div><div class="line">    <span class="comment">// configure GENIE and get the execution policy</span></div><div class="line">    <a class="code" href="classgenie_1_1Config.html">Config</a> config = <a class="code" href="classgenie_1_1Config.html">Config</a>()</div><div class="line">        .<a class="code" href="classgenie_1_1Config.html#ae2f8432643c1f1ebc88287336bc753f7">SetK</a>(5)</div><div class="line">        .<a class="code" href="classgenie_1_1Config.html#a9f6fa6160936c3a5c4c51f842d41b718">SetNumOfQueries</a>(5);</div><div class="line">    shared_ptr&lt;ExecutionPolicy&gt; policy = <a class="code" href="namespacegenie.html#a65a8a0a253fab2bc932af6d0c54c0183">MakePolicy</a>(config);</div><div class="line"></div><div class="line">    <span class="comment">// search with GENIE using the execution policy</span></div><div class="line">    <a class="code" href="namespacegenie.html#a6f616d3208c7b49dc2662842b5aaf95d">SearchResult</a> result = <a class="code" href="namespacegenie.html#a474230dd19d21b51f6e5dac6535d9364">Search</a>(policy, <span class="stringliteral">&quot;../static/sift_20.csv&quot;</span>, <span class="stringliteral">&quot;../static/sift_20.csv&quot;</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="usage_executable_sec"></a>
Using the GENIE executable</h2>
<p>For convenience, we have provided an executable for interfacing with GENIE. Once GENIE gets compiled, an executable named <code>genie</code> will appear in the <code>bin</code> folder. <code>./genie --help</code> shows you all the allowed options</p>
<div class="fragment"><div class="line">Allowed options:</div><div class="line">  --help                       produce help message</div><div class="line"></div><div class="line">  -k [ --k ] arg               k</div><div class="line">  -r [ --query-range ] arg     query range</div><div class="line">  -n [ --num-of-queries ] arg  number of queries</div><div class="line">  --gpu arg                    GPU to use</div><div class="line">  -t [ --table ] arg           table file</div><div class="line">  -q [ --query ] arg           query file</div></div><!-- fragment --><p>For example, you could run <code>./genie -k 10 -n 5 --gpu 2 -t ../static/sift_20.csv -q ../static/sift_20.csv</code> to match 5 queries with k set to 10 using gpu 2. Table and query are loaded from <code>../static/sift_20.csv</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
